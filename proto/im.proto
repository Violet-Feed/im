syntax = "proto3";
option java_package = "violet.video.common.proto_gen.im";
option go_package = "/proto_gen/im";

enum ConversationType{
  ConversationType_Not_Use = 0;
  ConversationType_One_Chat = 1;
  ConversationType_Group_Chat = 2;
  ConversationType_Service_Chat = 3;
  ConversationType_AI_Chat = 4;
  ConversationType_System_Chat = 5;
}

enum MessageType{
  MessageType_Not_Use = 0;
  MessageType_Text = 1;
  MessageType_Image = 2;
  MessageType_Video = 3;
  MessageType_Forward = 4;
  Message_Type_Cmd=1000;
}

message BaseResp{
  optional int32 StateCode=1;
  optional string StateMessage=2;
}
//TODO:message proto
message MessageBody{
  optional int64 UserId=1;
  optional string ConvId = 2;
  optional int64 ConvShortId = 3;
  optional int32 ConvType = 4;
  optional int64 MsgId=5;
  optional int32 MsgType = 6;
  optional string MsgContent = 7;
  optional int64 CreateTime=8;
}

message MessageEvent{
  optional MessageBody msgBody=1;
  optional int64 ConvIndex=2;
  optional bool Stored=3;
  optional int64 UserConvIndex=4;
  optional int64 PreUserConvIndex=5;
  optional int64 BadgeCount=6;
  optional int64 UserCmdIndex=7;
  optional int32 RetryCount=8;
}

message SendMessageRequest{
  optional string ConvId = 1;
  optional int64 ConvShortId = 2;
  optional int32 ConvType = 3;
  optional int32 MsgType = 4;
  optional string MsgContent = 5;
}

message SendMessageResponse{
  optional BaseResp baseResp = 1;
}

message GetMessageByInitRequest{
  optional int64 UserConvIndex=1;
}

message GetMessageByInitResponse{

}

message GetMessagesRequest{
  optional int64 ConvShortId=1;
  repeated int64 MsgIds=2;
}

message GetMessagesResponse{
  repeated MessageBody MsgBodies=1;
}

message SaveMessageRequest{
  optional MessageBody MsgBody=1;
}

message SaveMessageResponse{
  optional BaseResp baseResp = 1;
}
//TODO:conversation proto
message CreateConversationRequest{
  optional string ConvId=1;
  optional int32 ConvType=2;
  optional int64 OwnerId=3;
}

message CreateConversationResponse{
  optional int64 ConvShortId=1;
  optional string ConvInfo=2;
}

message IncrConversationBadgeRequest{
  optional int64 UserId=1;
  optional int64 ConvShortId=2;
}

message IncrConversationBadgeResponse{
  optional int64 BadgeCount=1;
}
//TODO:index proto
message AppendConversationIndexRequest{
  optional int64 ConvShortId=1;
  optional int64 MsgId=2;
}

message AppendConversationIndexResponse{
  optional int64 ConvIndex=1;
}

message PullConversationIndexRequest{
  optional int64 ConvShortId=1;
  optional int64 ConvIndex=2;
  optional int64 Limit=3;
}

message PullConversationIndexResponse{
  repeated int64 MsgIds=1;
}

message AppendUserConvIndexRequest{
  optional int64 UserId=1;
  optional int64 ConvShortId=2;
}

message AppendUserConvIndexResponse{
  optional int64 UserConvIndex=1;
  optional int64 PreUserConvIndex=2;
}

message AppendUserCmdIndexRequest{
  optional int64 UserId=1;
  optional int64 MsgId=2;
}

message AppendUserCmdIndexResponse{
  optional int64 UserCmdIndex=1;
}
//TODO:push
message PushRequest{
  optional MessageBody MsgBody=1;
  optional int64 ReceiverId=2;
  optional int64 ConvIndex=3;
  optional int64 UserConvIndex=4;
  optional int64 PreUserConvIndex=5;
  optional int64 BadgeCount=6;
  optional int64 UserCmdIndex=7;
}

message PushResponse{
  optional BaseResp baseResp=1;
}